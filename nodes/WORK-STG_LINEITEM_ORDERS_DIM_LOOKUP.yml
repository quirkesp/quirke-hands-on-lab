steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-a76404f0-57e5-4fb8-90e1-c61ed5a38584:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 1ef52409-5ec5-4e48-8d35-7ca286df2660
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1ba89c6b-05f2-4866-82ed-893a32480239
                    stepCounter: 1d8b131d-9f69-45bd-a9df-477d790a5073
                transform: ""
          - columnReference:
              columnCounter: b6808da1-2c45-43cc-90be-971c5576e931
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8a52e52d-61c9-436e-bb33-270f4de6b552
                    stepCounter: 9c3d40bd-cb98-4ea3-afcb-7715a46abb1a
                transform: ""
          - columnReference:
              columnCounter: fb16ec55-ebaf-45b9-ac9b-02ac07ae228f
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c75b6dc4-404e-4e73-837a-84208ed0a01e
                    stepCounter: 4db93654-721c-435d-8338-448467a3ca97
                transform: ""
          - columnReference:
              columnCounter: 3abd00d9-02a7-41dd-847d-46157a356dae
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ae031c4d-e09c-45c7-8af5-9a0487f0b835
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 0e399e0b-522f-40bd-8257-e93934b0e91c
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4597958c-3236-4940-b946-000729f26eba
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 952ecc7a-94d9-4413-b989-7d9ee9b369c2
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1c16d526-f04b-440c-8910-5f0bbfef2fb2
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: b8992725-581e-410f-a2ea-6d77fc047b90
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2c9385b8-f7e8-45ef-be4c-72c36efdb5d5
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: ebc082cd-f41c-4a32-aa50-d2520311809e
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4c8d98d9-0597-4759-8a90-7547cd3f4593
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 34d34b29-23b1-4ed0-9fa7-f316f12fbf84
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6b9cccfb-6b74-41e7-9f10-6ebf733eb287
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 5e7fa1fb-bde6-4cef-8ba9-e38e227f40f5
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d71848b4-966c-4461-aa2d-c57312371edb
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 199839f8-9ce3-4a36-a7ba-0e2adb528cb8
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 64dd8a66-12f0-4e8e-9c81-416761f5610e
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 55941ee7-2051-4503-8382-958270feede3
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3799ea16-4b78-4474-b465-66438065ff07
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 8e6d3d36-3137-453a-82a9-1820c44ecd12
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6a661486-5ff1-436c-a217-aaa0c6d660f7
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: a8b42bd6-907b-4d8a-b323-cd7b89e62eb9
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 27938557-2060-4bc2-824b-dd124abc697e
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 949f369d-e376-4122-be95-2bcafa714cff
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a5940cbf-6be4-4fe9-a87e-bd61b0b4e8bc
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 8fd53502-3fb7-4bf9-8677-e690cddad21d
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7bb78188-a5b1-401d-b7fb-55cc4559698d
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 4acbb901-5497-4958-b739-1450cd387ab7
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 29d05e1a-bfb4-4d45-9fff-01ec3fe3ca60
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 1197868c-09dd-4056-81eb-dc834c59d3fc
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 495641da-f46c-4b81-901d-f85c2e04589d
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 240c0a86-65dd-41e3-9dfc-41bf59d0da9a
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 31430514-07cc-45ca-824a-4c120e561fa9
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 75cfc749-650b-4a29-a9b7-b137c6016c80
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d7215c9d-e2cd-4068-a9eb-627355d5cd52
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 031b428a-db33-4f67-a5ea-cb14af6b52c9
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 41533a1a-f956-42ef-8f87-e11e6ac456f5
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: e4ae29f4-9a54-492e-8921-19efbb291c8c
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: aae11018-712d-4ba8-8db4-e88d060b73e3
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 78d42f8a-b4a4-40d8-89a4-651c68826fa1
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 71175e79-d598-4f0f-b920-bb25d89aaa33
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 33941039-0723-40a2-a982-76d3a4375872
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0ca2f9a0-2b59-417d-b148-c46c27504a24
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 2ef0d41e-372a-4d8f-a43a-0ee30eab2190
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7026ada7-1e5f-4119-ae81-19e8986e1ca2
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 69c0a544-9045-4e8e-b085-b15875a7fa76
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cdbb6aa2-0eaf-487f-b4f4-876dbb04925c
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 0e3e0886-4dbc-4454-b22b-46a3c690fefd
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8b5b07d8-55ea-45f4-8c4a-bd0bb4e6db7c
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 349ddc62-1253-462d-88c8-307b3f9f2b24
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 68aed9c0-da1c-4599-b419-6f6105318fc2
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 536b4f34-01ee-4a8b-8c39-88d88d1323bb
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a2cbc3fb-be82-43b6-8177-2095f1d13097
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
          - columnReference:
              columnCounter: 14823594-4c32-4d67-89e9-f1706d268563
              stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS_TO_SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7f700c6f-cbc3-41f3-a322-64a9949a7776
                    stepCounter: b48b233f-0de1-4546-bd2f-73e846894a1d
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 1d8b131d-9f69-45bd-a9df-477d790a5073
              DIM_PART: 9c3d40bd-cb98-4ea3-afcb-7715a46abb1a
              DIM_SUPPLIER: 4db93654-721c-435d-8338-448467a3ca97
              STG_LINEITEM_ORDERS: b48b233f-0de1-4546-bd2f-73e846894a1d
              STG_PARTSUPP: d170c0ed-e36b-497a-b318-e7ffded0011c
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: a76404f0-57e5-4fb8-90e1-c61ed5a38584
